<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SMAUG: smaug::SmvAcceleratorPool Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SMAUG
   </div>
   <div id="projectbrief">Simulating Machine Learning Applications on gem5-Aladdin</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesmaug.html">smaug</a></li><li class="navelem"><a class="el" href="classsmaug_1_1SmvAcceleratorPool.html">SmvAcceleratorPool</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classsmaug_1_1SmvAcceleratorPool-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">smaug::SmvAcceleratorPool Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements a pool of worker accelerators.  
 <a href="classsmaug_1_1SmvAcceleratorPool.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="smv__accel__pool_8h_source.html">smv_accel_pool.h</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements a pool of worker accelerators. </p>
<p>For operators that require work tiling, tiles can be distributed across multiple accelerators to exploit parallelism. This class implements a deterministic round-robin worker pool. Determinism is required because when generating multiple dynamic traces, worker accelerator assignments must match with simulation of the binary in <a class="el" href="namespacesmaug_1_1gem5.html" title="Contains utility functions for interacting with gem5.">gem5</a>.</p>
<p>To use:</p>
<div class="fragment"><div class="line">SmvAcceleratorPool pool(<a class="code" href="classsmaug_1_1SmvAcceleratorPool.html#ab527d58c28f046728be520c683873b69">size</a>);</div>
<div class="line"><span class="keywordtype">int</span> currAccel = 0;</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; tiles; i++) {</div>
<div class="line">   <span class="keyword">volatile</span> <span class="keywordtype">int</span>* finishFlag = <a class="code" href="namespacesmaug.html#a8e283c69f2d709034e9426931ef6f0fb">invokeKernelNoBlock</a>(currAccel, redCode, kernel, args...);</div>
<div class="line">   pool.addFinishFlag(currAccel, std::make_unique(finishFlag));</div>
<div class="line">   currAccel = pool.getNextAvailableAccelerator(currAccel);</div>
<div class="line">}</div>
<div class="line">pool.joinAll();</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="smv__accel__pool_8h_source.html#l00032">32</a> of file <a class="el" href="smv__accel__pool_8h_source.html">smv_accel_pool.h</a>.</p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a31ea1c9daf4378527f52b50b173f8157"><td class="memItemLeft" align="right" valign="top"><a id="a31ea1c9daf4378527f52b50b173f8157"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>SmvAcceleratorPool</b> (int _size)</td></tr>
<tr class="separator:a31ea1c9daf4378527f52b50b173f8157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae436c6e102756adfd5ee0f07aad4882d"><td class="memItemLeft" align="right" valign="top"><a id="ae436c6e102756adfd5ee0f07aad4882d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsmaug_1_1SmvAcceleratorPool.html#ae436c6e102756adfd5ee0f07aad4882d">addFinishFlag</a> (int accelIdx, std::unique_ptr&lt; volatile int &gt; finishFlag)</td></tr>
<tr class="memdesc:ae436c6e102756adfd5ee0f07aad4882d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a finish flag for the specified accelerator. <br /></td></tr>
<tr class="separator:ae436c6e102756adfd5ee0f07aad4882d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa725ada381f41d375c86eb95dea137d9"><td class="memItemLeft" align="right" valign="top"><a id="aa725ada381f41d375c86eb95dea137d9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsmaug_1_1SmvAcceleratorPool.html#aa725ada381f41d375c86eb95dea137d9">joinAll</a> ()</td></tr>
<tr class="memdesc:aa725ada381f41d375c86eb95dea137d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until all the finish flags turn complete. <br /></td></tr>
<tr class="separator:aa725ada381f41d375c86eb95dea137d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d5531e60fd07e1a4ccdedf141fd8d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsmaug_1_1SmvAcceleratorPool.html#a82d5531e60fd07e1a4ccdedf141fd8d6">getNextAvailableAccelerator</a> (int currAccelIdx)</td></tr>
<tr class="memdesc:a82d5531e60fd07e1a4ccdedf141fd8d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the next accelerator and wait if it's still busy.  <a href="classsmaug_1_1SmvAcceleratorPool.html#a82d5531e60fd07e1a4ccdedf141fd8d6">More...</a><br /></td></tr>
<tr class="separator:a82d5531e60fd07e1a4ccdedf141fd8d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a2e7aba1fad586cfd5da8c41fe1515563"><td class="memItemLeft" align="right" valign="top"><a id="a2e7aba1fad586cfd5da8c41fe1515563"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsmaug_1_1SmvAcceleratorPool.html#a2e7aba1fad586cfd5da8c41fe1515563">join</a> (int accelIdx)</td></tr>
<tr class="memdesc:a2e7aba1fad586cfd5da8c41fe1515563"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until this accelerator's finish flags turn complete. <br /></td></tr>
<tr class="separator:a2e7aba1fad586cfd5da8c41fe1515563"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab527d58c28f046728be520c683873b69"><td class="memItemLeft" align="right" valign="top"><a id="ab527d58c28f046728be520c683873b69"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsmaug_1_1SmvAcceleratorPool.html#ab527d58c28f046728be520c683873b69">size</a></td></tr>
<tr class="memdesc:ab527d58c28f046728be520c683873b69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of accelerators in the pool. <br /></td></tr>
<tr class="separator:ab527d58c28f046728be520c683873b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaca89247d404d094bec73695f7893dd"><td class="memItemLeft" align="right" valign="top"><a id="aaaca89247d404d094bec73695f7893dd"></a>
std::vector&lt; std::deque&lt; std::unique_ptr&lt; volatile int &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsmaug_1_1SmvAcceleratorPool.html#aaaca89247d404d094bec73695f7893dd">finishFlags</a></td></tr>
<tr class="memdesc:aaaca89247d404d094bec73695f7893dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Active finish flags for all the accelerators in the pool. <br /></td></tr>
<tr class="separator:aaaca89247d404d094bec73695f7893dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a82d5531e60fd07e1a4ccdedf141fd8d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82d5531e60fd07e1a4ccdedf141fd8d6">&#9670;&nbsp;</a></span>getNextAvailableAccelerator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int smaug::SmvAcceleratorPool::getNextAvailableAccelerator </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>currAccelIdx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the next accelerator and wait if it's still busy. </p>
<p>A round-robin scheduling policy is used for picking the accelerator. The simple static policy is used because the scheduling decisions need to be the same as when we generate the traces, whereas dynamic decisions that depend on runtime information may lead to mismatch between the traces and the simulation.</p>
<p>TODO(xyzsam): the pool should be able to keep track of the current accelerator index on its own. </p>

<p class="definition">Definition at line <a class="el" href="smv__accel__pool_8cpp_source.html#l00039">39</a> of file <a class="el" href="smv__accel__pool_8cpp_source.html">smv_accel_pool.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>smaug/operators/smv/<a class="el" href="smv__accel__pool_8h_source.html">smv_accel_pool.h</a></li>
<li>smaug/operators/smv/<a class="el" href="smv__accel__pool_8cpp_source.html">smv_accel_pool.cpp</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclasssmaug_1_1SmvAcceleratorPool_html_ab527d58c28f046728be520c683873b69"><div class="ttname"><a href="classsmaug_1_1SmvAcceleratorPool.html#ab527d58c28f046728be520c683873b69">smaug::SmvAcceleratorPool::size</a></div><div class="ttdeci">int size</div><div class="ttdoc">Number of accelerators in the pool.</div><div class="ttdef"><b>Definition:</b> <a href="smv__accel__pool_8h_source.html#l00060">smv_accel_pool.h:60</a></div></div>
<div class="ttc" id="anamespacesmaug_html_a8e283c69f2d709034e9426931ef6f0fb"><div class="ttname"><a href="namespacesmaug.html#a8e283c69f2d709034e9426931ef6f0fb">smaug::invokeKernelNoBlock</a></div><div class="ttdeci">std::unique_ptr&lt; volatile int &gt; invokeKernelNoBlock(int accelIdx, unsigned reqCode, const Kernel &amp;kernel, Args &amp;&amp;... args)</div><div class="ttdoc">A generic non-blocking interface to accelerated kernel functions.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00106">common.h:106</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
